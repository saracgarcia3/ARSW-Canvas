<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-time Drawing</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.7.1/p5.min.js"></script>
</head>
<body>
    <button onclick="clearBoard()">Clear Board</button>

    <script>
        const socket = new WebSocket('ws://localhost:8080/draw');

        socket.onmessage = function(event) {
            const data = JSON.parse(event.data);
            if (data.clear) {
                clearCanvas();
            } else {
                drawReceived(data.x, data.y, data.color); 
            }
        };

        function sendDrawing(x, y, color) {
            const data = { x: x, y: y, color: color };
            socket.send(JSON.stringify(data));  
        }

        function clearBoard() {
            socket.send(JSON.stringify({ clear: true }));
            clearCanvas();
        }

        function clearCanvas() {
            background(255);  
        }

        let currentColor = 'black';  


        function setup() {
            createCanvas(640, 480);
            background(255);  
        }

        function draw() {
            if (mouseIsPressed) {
                fill(currentColor);
                ellipse(mouseX, mouseY, 20, 20);  
                sendDrawing(mouseX, mouseY, currentColor);  
            }
        }

        function drawReceived(x, y, color) {
            fill(color);
            ellipse(x, y, 20, 20);  
        }
    </script>
</body>
</html>
